
<div class="text-center">
    <h1 *ngIf="selectedScript">{{selectedScript.name}}</h1>
    <h1 *ngIf="!selectedScript">Name</h1>
</div>

<div class="text-center">
    <select [(ngModel)]="selectedScript" (change)="onChange()" class="text-center">
        <option *ngFor="let script of scripts"
                [ngValue]="script">
            {{script.name }}
        </option>
    </select>
</div>

<div *ngIf="selectedScript">
    <p>{{selectedScript.description}}</p>
    <ul>
        <li *ngFor="let tag of selectedScript.tags">
            {{tag.name}}
        </li>
    </ul>
    <p *ngIf="!parameters"><em>Loading...</em></p>

    <table class='table' *ngIf="parameters">
        <thead>
            <tr>
                <th>Name</th>
                <th>Value</th>
                <th>Unit</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let parameter of parameters">
                <td [innerHTML]="parameter.name | html"></td>
                <td>
                    <div *ngIf="parameter.context % (2 * parameterOptions.Editable) >= parameterOptions.Editable">
                        <input *ngIf="parameter.valueOptions.length == 0"
                               [(ngModel)]="parameter.value"
                               placeholder="value" 
                               (change)="setValueChanged()"/>
                        <select *ngIf="parameter.valueOptions.length > 0"
                                [(ngModel)]="parameter.value"
                                (change)="setValueChanged()">
                            <option *ngFor="let valueOption of parameter.valueOptions">
                                {{valueOption.value }}
                            </option>
                        </select>
                    </div>
                    <span *ngIf="parameter.context % (2 * parameterOptions.Calculation) >= parameterOptions.Calculation">{{parameter.value }}</span>
                </td>
                <td [innerHTML]="parameter.unit | html"></td>
                <td>{{ parameter.description }}</td>
            </tr>
        </tbody>
    </table>

    <button (click)="calculate()">Calculate</button>

    <table class='table' *ngIf="resultParameters && !valueChanged">
        <thead>
            <tr>
                <th>Name</th>
                <th>Value</th>
                <th>Unit</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let parameter of resultParameters">
                <td [innerHTML]="parameter.name | html"></td>
                <td>
                    <div *ngIf="parameter.context % (2 * parameterOptions.Editable) >= parameterOptions.Editable">
                        <input *ngIf="parameter.valueOptions.length == 0"
                               [(ngModel)]="parameter.value"
                               placeholder="value" />
                        <select *ngIf="parameter.valueOptions.length > 0"
                                [(ngModel)]="parameter.value">
                            <option *ngFor="let valueOption of parameter.valueOptions">
                                {{valueOption.value }}
                            </option>
                        </select>
                    </div>
                    <span *ngIf="parameter.context % (2 * parameterOptions.Calculation) >= parameterOptions.Calculation">{{parameter.value }}</span>
                </td>
                <td [innerHTML]="parameter.unit | html"></td>
                <td>{{ parameter.description }}</td>
            </tr>
        </tbody>
    </table>
</div>
